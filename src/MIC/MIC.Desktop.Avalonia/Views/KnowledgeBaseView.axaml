
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:MIC.Desktop.Avalonia.ViewModels"
             mc:Ignorable="d"
             x:Class="MIC.Desktop.Avalonia.Views.KnowledgeBaseView"
             x:DataType="vm:KnowledgeBaseViewModel"
             Background="#0F172A">

    <ScrollViewer VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled">
        <Grid Margin="24">
            <StackPanel Spacing="16">
                <!-- Page Header -->
                <StackPanel Spacing="8" Margin="0,0,0,8">
                    <TextBlock Text="KNOWLEDGE BASE"
                               Classes="title"
                               Foreground="{StaticResource PrimaryGoldBrush}" />
                    <TextBlock Text="Central hub for indexed insights from emails, attachments, and alerts"
                               Classes="subtitle" />
                </StackPanel>

                <!-- Main Content Card -->
                <Border Classes="glass-card-premium" Padding="20">
                    <StackPanel Spacing="16">
                        
                        <!-- Upload Section -->
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <Button Content="Upload Documents"
                                    Width="180"
                                    Height="36"
                                    Command="{Binding UploadDocumentsCommand}"
                                    Classes="golden"
                                    FontWeight="Medium" />
                            
                            <TextBlock Text="Up to 50 files, 150MB each"
                                       FontSize="12"
                                       Foreground="{StaticResource TextMutedBrush}"
                                       VerticalAlignment="Center" />
                        </StackPanel>

                        <!-- Search Box -->
                        <TextBox Watermark="Search knowledge base..."
                                 Text="{Binding SearchText, Mode=TwoWay}"
                                 Height="36"
                                 CornerRadius="8"
                                 FontSize="14"
                                 Background="{StaticResource BackgroundDeepBrush}"
                                 Foreground="{StaticResource TextPrimaryBrush}"
                                 BorderBrush="{StaticResource BorderSubtleBrush}"
                                 BorderThickness="1" />

                        <!-- Success Message -->
                        <Border Background="{StaticResource SuccessLightBrush}"
                                CornerRadius="8"
                                Padding="12"
                                BorderBrush="{StaticResource SuccessBrush}"
                                BorderThickness="1"
                                IsVisible="{Binding !!SuccessMessage}">
                            <TextBlock Text="{Binding SuccessMessage}"
                                       Foreground="{StaticResource SuccessBrush}"
                                       FontSize="13"
                                       TextWrapping="Wrap" />
                        </Border>

                        <!-- Error Message -->
                        <Border Background="{StaticResource ErrorLightBrush}"
                                CornerRadius="8"
                                Padding="12"
                                BorderBrush="{StaticResource ErrorBrush}"
                                BorderThickness="1"
                                IsVisible="{Binding !!ErrorMessage}">
                            <TextBlock Text="{Binding ErrorMessage}"
                                       Foreground="{StaticResource ErrorBrush}"
                                       FontSize="13"
                                       TextWrapping="Wrap" />
                        </Border>

                        <!-- Loading Indicator -->
                        <Border CornerRadius="8"
                                Padding="16"
                                IsVisible="{Binding IsLoading}">
                            <StackPanel Spacing="8" HorizontalAlignment="Center">
                                <ProgressBar IsIndeterminate="True"
                                             Width="200"
                                             Height="4"
                                             Foreground="{StaticResource PrimaryGoldBrush}" />
                                <TextBlock Text="Uploading documents..."
                                           FontSize="13"
                                           Foreground="{StaticResource TextMutedBrush}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                        </Border>

                        <!-- Documents List -->
                        <ScrollViewer MaxHeight="500"
                                      VerticalScrollBarVisibility="Auto">
                            <ItemsControl ItemsSource="{Binding Entries}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate x:DataType="vm:KnowledgeEntryViewModel">
                                        <Border Classes="metric-card"
                                                Padding="16"
                                                Margin="0,0,0,12">
                                            <StackPanel Spacing="8">
                                                <!-- Title -->
                                                <TextBlock Text="{Binding Title}"
                                                           FontSize="16"
                                                           FontWeight="SemiBold"
                                                           Foreground="{StaticResource TextPrimaryBrush}"
                                                           TextWrapping="Wrap" />
                                                
                                                <!-- Content Preview -->
                                                <TextBlock Text="{Binding Content}"
                                                           FontSize="13"
                                                           Foreground="{StaticResource TextSecondaryBrush}"
                                                           TextWrapping="Wrap"
                                                           MaxLines="3"
                                                           TextTrimming="CharacterEllipsis" />
                                                
                                                <!-- Metadata -->
                                                <StackPanel Orientation="Horizontal" Spacing="12">
                                                    <TextBlock Text="{Binding Tags}"
                                                               FontSize="12"
                                                               Foreground="{StaticResource PrimaryGoldBrush}" />
                                                    
                                                    <TextBlock Text="â€¢"
                                                               FontSize="12"
                                                               Foreground="{StaticResource TextMutedBrush}" />
                                                    
                                                    <TextBlock Text="{Binding CreatedAt, StringFormat='Created {0:MMM dd, yyyy HH:mm}'}"
                                                               FontSize="12"
                                                               Foreground="{StaticResource TextMutedBrush}" />
                                                </StackPanel>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>

                        <!-- Empty State -->
                        <Border CornerRadius="12"
                                Padding="40"
                                IsVisible="{Binding !Entries.Count}">
                            <StackPanel Spacing="12" HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ“š"
                                           FontSize="48"
                                           HorizontalAlignment="Center" />
                                
                                <TextBlock Text="No documents yet"
                                           FontSize="16"
                                           FontWeight="SemiBold"
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           HorizontalAlignment="Center" />
                                
                                <TextBlock Text="Upload documents to build your knowledge base"
                                           FontSize="13"
                                           Foreground="{StaticResource TextMutedBrush}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                        </Border>

                    </StackPanel>
                </Border>
            </StackPanel>
        </Grid>
    </ScrollViewer>

</UserControl>
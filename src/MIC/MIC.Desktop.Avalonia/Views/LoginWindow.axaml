<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:MIC.Desktop.Avalonia.ViewModels"
        mc:Ignorable="d" d:DesignWidth="500" d:DesignHeight="700"
        x:Class="MIC.Desktop.Avalonia.Views.LoginWindow"
        x:DataType="vm:LoginViewModel"
        Title="Mbarie Intelligence Console"
        Width="480" Height="700"
        WindowStartupLocation="CenterScreen"
        CanResize="False"
        Background="#0A0A0F"
        ExtendClientAreaToDecorationsHint="False"
        SystemDecorations="Full">

    <Window.Styles>
        <Style Selector="TextBlock.title">
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#FFFFFF"/>
        </Style>
        <Style Selector="TextBlock.label">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#94A3B8"/>
            <Setter Property="FontWeight" Value="Medium"/>
        </Style>
        <Style Selector="TextBox.input">
            <Setter Property="Background" Value="#1E293B"/>
            <Setter Property="BorderBrush" Value="#334155"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="#F8FAFC"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>
        <Style Selector="Button.golden">
            <Setter Property="Foreground" Value="#0A0A0F"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16,12"/>
        </Style>
    </Window.Styles>

    <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                  VerticalScrollBarVisibility="Auto">
        <Panel>
            <!-- Background Gradient -->
            <Border>
                <Border.Background>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="0%,100%">
                        <GradientStop Color="#0A0A0F" Offset="0" />
                        <GradientStop Color="#1A1520" Offset="1" />
                    </LinearGradientBrush>
                </Border.Background>
            </Border>

            <!-- Content -->
            <StackPanel Margin="40,32"
                        HorizontalAlignment="Stretch"
                        Spacing="24">
                
                <!-- Logo and Title -->
                <StackPanel HorizontalAlignment="Center" Spacing="16">
                    <!-- Logo Icon -->
                    <Border Width="80" Height="80"
                            CornerRadius="20"
                            HorizontalAlignment="Center"
                            BorderBrush="#FFB84D"
                            BorderThickness="2"
                            BoxShadow="0 10 30 -5 rgba(255, 184, 77, 0.5)">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                <GradientStop Color="#FFB84D" Offset="0" />
                                <GradientStop Color="#FF8C42" Offset="1" />
                            </LinearGradientBrush>
                        </Border.Background>
                        <TextBlock Text="M"
                                   FontSize="42"
                                   FontWeight="Bold"
                                   Foreground="#0A0A0F"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center" />
                    </Border>
                    
                    <TextBlock Text="MBARIE"
                               FontSize="28"
                               FontWeight="Light"
                               Foreground="#FFFFFF"
                               LetterSpacing="6"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="Intelligence Console"
                               FontSize="13"
                               Foreground="#94A3B8"
                               LetterSpacing="2"
                               HorizontalAlignment="Center" />
                </StackPanel>

                <!-- Error Message (shown for both login and registration) -->
                <Border IsVisible="{Binding ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                        Background="#450A0A"
                        BorderBrush="#EF4444"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="12">
                    <TextBlock Text="{Binding ErrorMessage}"
                               Foreground="#EF4444"
                               FontSize="13"
                               TextWrapping="Wrap" />
                </Border>

                <!-- Login Form -->
                <Border Background="#1E293B"
                        BorderBrush="#FFB84D"
                        BorderThickness="1"
                        CornerRadius="12"
                        Padding="28"
                        IsVisible="{Binding !ShowRegistration}">
                    <StackPanel Spacing="20">
                        
                        <TextBlock Text="Welcome Back"
                                   Classes="title"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,8" />

                        <!-- Username -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="USERNAME" Classes="label" />
                            <TextBox Text="{Binding Username}"
                                     Watermark="Enter your username"
                                     Classes="input" />
                        </StackPanel>

                        <!-- Password -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="PASSWORD" Classes="label" />
                            <TextBox Text="{Binding Password}"
                                     PasswordChar="*"
                                     Watermark="Enter your password"
                                     Classes="input">
                                <TextBox.KeyBindings>
                                    <KeyBinding Command="{Binding LoginCommand}" Gesture="Enter" />
                                </TextBox.KeyBindings>
                            </TextBox>
                        </StackPanel>

                        <!-- Remember Me -->
                        <CheckBox IsChecked="{Binding RememberMe}"
                                  Foreground="#F8FAFC"
                                  Margin="0,4,0,0">
                            <TextBlock Text="Keep me signed in" FontSize="13" />
                        </CheckBox>

                        <!-- Login Button -->
                        <Border CornerRadius="8"
                                BoxShadow="0 10 15 -3 rgba(255, 184, 77, 0.5)"
                                Margin="0,8,0,0">
                            <Button Command="{Binding LoginCommand}"
                                    Classes="golden"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center"
                                    IsEnabled="{Binding !IsLoading}">
                                <Button.Background>
                                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                                        <GradientStop Color="#FFB84D" Offset="0" />
                                        <GradientStop Color="#FF8C42" Offset="1" />
                                    </LinearGradientBrush>
                                </Button.Background>
                                <Panel>
                                    <TextBlock Text="SIGN IN"
                                               IsVisible="{Binding !IsLoading}"
                                               LetterSpacing="2" />
                                    <StackPanel Orientation="Horizontal"
                                                Spacing="10"
                                                IsVisible="{Binding IsLoading}">
                                        <ProgressBar IsIndeterminate="True"
                                                     Width="20" Height="20"
                                                     Foreground="#0A0A0F" />
                                        <TextBlock Text="SIGNING IN..."
                                                   LetterSpacing="2" />
                                    </StackPanel>
                                </Panel>
                            </Button>
                        </Border>

                        <!-- Divider -->
                        <Border Height="1" 
                                Background="#334155" 
                                Margin="0,8,0,8" />

                        <!-- Sign Up Link -->
                        <Button Command="{Binding ShowRegisterCommand}"
                                Background="Transparent"
                                BorderThickness="0"
                                Padding="0"
                                HorizontalAlignment="Center">
                            <StackPanel Orientation="Horizontal" Spacing="4">
                                <TextBlock Text="Don't have an account?"
                                           Foreground="#94A3B8"
                                           FontSize="13" />
                                <TextBlock Text="Sign Up"
                                           Foreground="#FFB84D"
                                           FontSize="13"
                                           FontWeight="SemiBold" />
                            </StackPanel>
                        </Button>

                        <!-- Guest Login -->
                        <Button Command="{Binding ContinueAsGuestCommand}"
                                Background="#334155"
                                Foreground="#F8FAFC"
                                BorderThickness="0"
                                CornerRadius="8"
                                Padding="12,10"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                FontSize="12">
                            <TextBlock Text="Continue as Guest" />
                        </Button>

                    </StackPanel>
                </Border>

                <!-- Registration Form -->
                <Border Background="#1E293B"
                        BorderBrush="#FFB84D"
                        BorderThickness="1"
                        CornerRadius="12"
                        Padding="28"
                        IsVisible="{Binding ShowRegistration}">
                    <StackPanel Spacing="18">
                        
                        <TextBlock Text="Create Account"
                                   Classes="title"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,8" />
                        
                        <!-- Username -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="USERNAME *" Classes="label" />
                            <TextBox Text="{Binding RegisterUsername}"
                                     Watermark="Choose a username"
                                     Classes="input" />
                        </StackPanel>
                        
                        <!-- Email -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="EMAIL ADDRESS *" Classes="label" />
                            <TextBox Text="{Binding RegisterEmail}"
                                     Watermark="Enter your email"
                                     Classes="input" />
                        </StackPanel>
                        
                        <!-- Full Name -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="FULL NAME (Optional)" Classes="label" />
                            <TextBox Text="{Binding RegisterFullName}"
                                     Watermark="Enter your full name"
                                     Classes="input" />
                        </StackPanel>
                        
                        <!-- Password -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="PASSWORD *" Classes="label" />
                            <TextBox Text="{Binding RegisterPassword}"
                                     PasswordChar="*"
                                     Watermark="At least 8 characters"
                                     Classes="input" />
                        </StackPanel>
                        
                        <!-- Confirm Password -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="CONFIRM PASSWORD *" Classes="label" />
                            <TextBox Text="{Binding RegisterConfirmPassword}"
                                     PasswordChar="*"
                                     Watermark="Re-enter your password"
                                     Classes="input">
                                <TextBox.KeyBindings>
                                    <KeyBinding Command="{Binding RegisterCommand}" Gesture="Enter" />
                                </TextBox.KeyBindings>
                            </TextBox>
                        </StackPanel>

                        <!-- Register Button -->
                        <Border CornerRadius="8"
                                BoxShadow="0 10 15 -3 rgba(255, 184, 77, 0.5)"
                                Margin="0,8,0,0">
                            <Button Command="{Binding RegisterCommand}"
                                    Classes="golden"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center"
                                    IsEnabled="{Binding !IsLoading}">
                                <Button.Background>
                                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                                        <GradientStop Color="#FFB84D" Offset="0" />
                                        <GradientStop Color="#FF8C42" Offset="1" />
                                    </LinearGradientBrush>
                                </Button.Background>
                                <Panel>
                                    <TextBlock Text="CREATE ACCOUNT"
                                               IsVisible="{Binding !IsLoading}"
                                               LetterSpacing="2" />
                                    <StackPanel Orientation="Horizontal"
                                                Spacing="10"
                                                IsVisible="{Binding IsLoading}">
                                        <ProgressBar IsIndeterminate="True"
                                                     Width="20" Height="20"
                                                     Foreground="#0A0A0F" />
                                        <TextBlock Text="CREATING..."
                                                   LetterSpacing="2" />
                                    </StackPanel>
                                </Panel>
                            </Button>
                        </Border>

                        <!-- Divider -->
                        <Border Height="1" 
                                Background="#334155" 
                                Margin="0,8,0,8" />

                        <!-- Back to Login -->
                        <Button Command="{Binding BackToLoginCommand}"
                                Background="Transparent"
                                BorderThickness="0"
                                Padding="0"
                                HorizontalAlignment="Center">
                            <StackPanel Orientation="Horizontal" Spacing="4">
                                <TextBlock Text="Already have an account?"
                                           Foreground="#94A3B8"
                                           FontSize="13" />
                                <TextBlock Text="Sign In"
                                           Foreground="#FFB84D"
                                           FontSize="13"
                                           FontWeight="SemiBold" />
                            </StackPanel>
                        </Button>

                    </StackPanel>
                </Border>

                <!-- Footer -->
                <TextBlock Text="© 2025 Mbarie Services Ltd. All rights reserved."
                           FontSize="11"
                           Foreground="#455A64"
                           HorizontalAlignment="Center"
                           Margin="0,8,0,16" />

            </StackPanel>
        </Panel>
    </ScrollViewer>
</Window>

<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:MIC.Desktop.Avalonia.ViewModels"
             x:Class="MIC.Desktop.Avalonia.Views.PredictionsView"
             x:DataType="vm:PredictionsViewModel"
             Background="{StaticResource BackgroundGradient}">

    <Grid RowDefinitions="Auto,Auto,*">

        <!-- Header -->
        <StackPanel Grid.Row="0" Spacing="8" Margin="0,0,0,24">
            <TextBlock Text="ðŸ”® AI PREDICTIONS"
                       Classes="title"
                       Foreground="{StaticResource PrimaryGoldBrush}"/>
            <TextBlock Text="Future forecasting based on historical patterns and AI analysis"
                       Classes="subtitle"/>
        </StackPanel>

        <!-- Controls -->
        <Border Grid.Row="1" Classes="glass-card-premium" Margin="0,0,0,16" Padding="16">
            <Grid ColumnDefinitions="Auto,*,Auto,Auto,Auto">

                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                    <TextBlock Text="Time Horizon:"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               VerticalAlignment="Center"/>
                    <ComboBox SelectedIndex="1" Width="150">
                        <ComboBoxItem Content="7 days"/>
                        <ComboBoxItem Content="30 days"/>
                        <ComboBoxItem Content="90 days"/>
                        <ComboBoxItem Content="6 months"/>
                        <ComboBoxItem Content="12 months"/>
                    </ComboBox>
                </StackPanel>

                <Button Grid.Column="2"
                        Content="ðŸ”„ Refresh"
                        Command="{Binding RefreshCommand}"
                        Classes="outline-golden"
                        Margin="12,0,0,0"/>

                <Button Grid.Column="3"
                        Content="âœ¨ Generate"
                        Command="{Binding GeneratePredictionsCommand}"
                        Classes="golden"
                        Margin="12,0,0,0"/>

                <Button Grid.Column="4"
                        Content="ðŸ“„ Export"
                        Command="{Binding ExportPredictionsCommand}"
                        Classes="outline-golden"
                        Margin="12,0,0,0"/>

            </Grid>
        </Border>

        <!-- Predictions List -->
        <ScrollViewer Grid.Row="2">
            <ItemsControl ItemsSource="{Binding Predictions}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Classes="metric-card" Margin="0,0,0,16">
                            <Grid RowDefinitions="Auto,Auto,Auto,Auto" ColumnDefinitions="Auto,*,Auto">

                                <!-- Icon/Category -->
                                <Border Grid.Row="0" Grid.RowSpan="4" Grid.Column="0"
                                        Width="60" Height="60"
                                        CornerRadius="30"
                                        Background="{StaticResource GoldenGradient}"
                                        VerticalAlignment="Top"
                                        Margin="0,0,16,0">
                                    <TextBlock Text="ðŸ”®"
                                               FontSize="28"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"/>
                                </Border>

                                <!-- Title -->
                                <TextBlock Grid.Row="0" Grid.Column="1"
                                           Text="{Binding Title}"
                                           FontSize="18"
                                           FontWeight="SemiBold"
                                           Foreground="{StaticResource TextPrimaryBrush}"/>

                                <!-- Description -->
                                <TextBlock Grid.Row="1" Grid.Column="1"
                                           Text="{Binding Description}"
                                           FontSize="14"
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           TextWrapping="Wrap"
                                           Margin="0,8,0,0"/>

                                <!-- Metadata -->
                                <StackPanel Grid.Row="2" Grid.Column="1"
                                            Orientation="Horizontal"
                                            Spacing="16"
                                            Margin="0,12,0,0">
                                    <TextBlock FontSize="12" Foreground="{StaticResource TextTertiaryBrush}">
                                        <Run Text="ðŸ“"/>
                                        <Run Text="{Binding Category}"/>
                                    </TextBlock>
                                    <TextBlock FontSize="12" Foreground="{StaticResource TextTertiaryBrush}">
                                        <Run Text="ðŸ“…"/>
                                        <Run Text="{Binding OccurrenceDate, StringFormat='Expected: {0:MMM dd, yyyy}'}"/>
                                    </TextBlock>
                                    <TextBlock FontSize="12" Foreground="{StaticResource TextTertiaryBrush}">
                                        <Run Text="â±ï¸"/>
                                        <Run Text="{Binding TimeHorizon}"/>
                                    </TextBlock>
                                </StackPanel>

                                <!-- Confidence Badge -->
                                <Border Grid.Row="0" Grid.Column="2"
                                        CornerRadius="12"
                                        Padding="12,6"
                                        VerticalAlignment="Top">
                                    <Border.Background>
                                        <SolidColorBrush Color="{Binding ConfidenceColor}"/>
                                    </Border.Background>
                                    <StackPanel Spacing="2">
                                        <TextBlock Text="Confidence"
                                                   FontSize="9"
                                                   Foreground="White"
                                                   HorizontalAlignment="Center"/>
                                        <TextBlock Text="{Binding ConfidencePercentage}"
                                                   FontSize="14"
                                                   FontWeight="Bold"
                                                   Foreground="White"
                                                   HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>

                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!-- Empty State -->
        <Border Grid.Row="2"
                Classes="glass-card-premium"
                IsVisible="{Binding !Predictions.Count}"
                Padding="60">
            <StackPanel Spacing="16" HorizontalAlignment="Center">
                <TextBlock Text="ðŸ”®"
                           FontSize="64"
                           HorizontalAlignment="Center"/>
                <TextBlock Text="No predictions yet"
                           Classes="section-title"
                           HorizontalAlignment="Center"/>
                <TextBlock Text="Click 'Generate' to create AI-powered forecasts"
                           Classes="subtitle"
                           HorizontalAlignment="Center"/>
                <Button Content="âœ¨ Generate Predictions"
                        Command="{Binding GeneratePredictionsCommand}"
                        Classes="golden"
                        HorizontalAlignment="Center"/>
            </StackPanel>
        </Border>

    </Grid>

</UserControl>
